# Methylation Data: Age of patient
ages <- c(69.1,65.1,67.6,56.7,59.4,57.5,64.5,81.9,83.7,47,31.9,58.8,79.3,57.5,60.5,74,64.1,71.1,52.7,67.6,56.1,69.5,75.7,66.3,
          65.9,74.2,55.7,60,79.9,83,75,53.2,61,60.4,70.7,64.5,71.5,47.2,48.1,31.2,75.8,75.6,62.6,60.7,80.2,65.6,56.9,56.4,56.4,
          55.3,56.3,72,68.5,70.2,69.6,49.8,52.6,62.8,64.6,62.6,59.3,63.9,61.3,65,60.3,64.4,49.5,62.1,69.3,57.2,46,64.2,49.1,60,
          56,43.9,71.2,49.9,38.5,73.3,69.9,64.1,44.8,61.1,63.1,57,59.8,70,62.3,50.5,61.5,71.8,51.4,60.6,67.9,54.8,64,54.6,61.5,
          70.7,70.7,66.3,72.6,68.2,56.1,63.3,78.7,69.6,52.1,69.8,64,69.9,73.5,67.8,57.9,66.5,69.6,67.1,73,69.8,55.8,37.3,70.4,
          51.4,57.4,53.2,67.1,60.1,70.5,60.8,54.7,57.8,39.4,81.3,69,55,65.7,63.4,47.8,56.8,62.2,64.2,68.3,46.9,63.3,38.3,64.8,
          66.2,67.2,64.9,74.6,78,69.3,77.3,74.7,64.7,53.5,56,70.8,60.4,54.6,66.6,68.9,54.4,50.6,66.8,78.8,67.5,51.8,56,69.1,
          32.3,75.7,44,48.9,67,41.6,64.1,39.2,61.3,45.2,53.2,40.2,68.6,71.4,60.8,70.6,49.8,70.1,53.7,48,70.1,51.3,66.1,51.8,
          71.6,65.9,50.5,47.3,39.2,61.4,54.8,39.7,57.5,69.4,64.2,65.7,68.5,65.4,53.1,61.6,63.3,81.8,51,57.1,59.6,74.3,63.4,
          53.9,68.8,48.1,75.5,56.7,66,63.1,51.7,70.5,62.9,51.2,63.8,66.9,57.4,57,57.4,73.5,61.3,48.3,65.8,76.9,57.8,72.3,62.6,
          53.8,66.6,61.8,59.5,66.5,71.1,78.3,45.5,72.9,73.5,71,64.6,54.2,55.6,61.4,62,59.1,64.7,61.8,59.8,42.3,70.3,55.4,64.3,
          65.7,65.2,69.9,51,38,60.3,69,54,49.4,65.7,72.3,45.8,57.7,52.4,65.1,61,67.7,69.2,63.3,49.2,62.9,52.5,49.2,62.7,62.3,
          55.4,32.3,69.2,53.6,61,67,59.1,72,53.3,61.2,68,54.8,69,43.1,56.7,64.2,57.2,66,44.7,79.2,69.9,58.2,71.1,76.2,60.7,
          57.7,77.3,52.4,76,62.4,71.7,62.7,65.8,61.4,71.7,68.7,55.2,37,53,68.1,52.2,68.2,71.2,48.3,70.4,69.4,75.7,57.7,73.9,
          69.4,61.9,77,52.9,71.3,38.3,41.5,71.7,68.7,78.8,71.1,69,58.7,52.1,57.9,52.9,69.7,69.8,43.2,69.2,53.6,64.4,53.9,
          63.6,68.9,75.8,73.3,36.6,69,58.4,39.2,82.7,59.4,56.7,66.5,49.9,65,72.5,59.9,42.8,42.2,51.6,50.5,65.3,63.7,63.9,54.9,
          60.8,72.8,47.5,63.3,72.3,49.2,75.1,66.4,48.8,74.7,62.1,68,50,55,60.5,49.6,70.8,53.1,66.5,48.7,62.2,64.2,46.6,72.6,
          62.8,60.8,61.6,57.2,47.4,59.6,60,48.2,70.1,63.2,71.4,45.9,73.5,57.4,68.4,77,51.3,77.2,49.6,58.9,59.6,58.2,66.6,59,
          66.4,66.8,72,67.2,70.9,73.9,53.5,33.7,66.9,66.6,59.9,68.1,65.8,65.3,64,60.3,71.1,64,55.7,67.1,66.8,55.7,80.9)

# Define age ranges
age_ranges <- cut(ages, breaks = c(30, 40, 50, 60, 70, 80, 90), labels = c("30-40", "40-50", "50-60", "60-70", "70-80", "80-90"))

# Create a table of frequencies
age_table <- table(age_ranges)
age_df <- as.data.frame(age_table)
age_df$Age_Range <- as.character(age_df$age_ranges)

# Define a function to generate a gradient color palette
gradient_palette <- colorRampPalette(c("#36C3D1","#F1746B"))
# Generate gradient colors
gradient_colors <- gradient_palette(length(age_table))

# Create ggplot
ggplot(age_df, aes(x = Age_Range, y = Freq, fill = Age_Range)) +
  geom_bar(stat = "identity") +
  labs(title = "Methylation data: Age distribution of patient", x = "\nAge Range (in years)", y = "Frequency\n", fill = "Age Range") +
  scale_fill_manual(values = gradient_colors, name = "Age Range") +
  theme_bw() + 
  theme(
    axis.text = element_text(face = "bold", size = 14, color = 'black'),
    axis.title = element_text(face = "bold", size = 16, color = 'black'),
    axis.text.x = element_text(color = 'black'),
    legend.position = "none",
    panel.grid.major = element_blank(),
    panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
    plot.title = element_text(face = "bold", size = 18)
  ) +
  geom_text(aes(label = Freq), vjust = -0.5, size = 4) +
  scale_y_continuous(breaks = seq(0, max(age_df$Freq), by = 20)) +
  geom_hline(yintercept = seq(0, max(age_df$Freq), by = 50), linetype = "dotted", color = "gray", size = 0.2)
